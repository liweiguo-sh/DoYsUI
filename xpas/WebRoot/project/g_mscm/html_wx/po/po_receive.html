<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <title>订单接收</title>
    <script src="../../../../res/jscript/xwf.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.ajax.js" type="text/javascript"></script>	
	<script src="../../../../res/jscript/xwf.const.js" type="text/javascript"></script>
	
	<link href="../../../../res_plugin/bootstrap3.7/bootstrap/css/bootstrap.min.css"   rel="stylesheet" type="text/css" />
	<link href="../../../../res_plugin/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
	<script src="../../../../res_plugin/jquery/jquery-3.1.1.min.js" type="text/javascript"></script>
    <script src="../../../../res_plugin/bootstrap3.7/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>

    <script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
    <script src="../../../../res/jscript_mobile/xmf.wx.js"></script>
    <link rel="stylesheet" href="../../css/common.css">
    <style>
       body {
			margin: 0px;
			padding: 10px;			
			background-color: #e8e9eb;
		}
		#imgHead {
			width:100%;height:auto;
		}

		#tbMain {
			width: 100%;
			table-layout: fixed;
			border-collapse: collapse;
			background-color: white;
			border-top: dashed 1px Olive;
			border-bottom: dashed 1px Olive;
		}
		
		.label-title {
			color: darkGray;
			text-align:right;
			font-size: 1em;
			border:0px solid green;
			width:100%;
			height:30px;
		}
		.label-value {
			font-size: 1em;
			text-align:left;
			color: Black;
			border:0px solid green;
			width:100%;
			height:30px;
		}
		.label-balance {
			font-size: 1.2em;
			font-family:Arial Black;
			color: Navy;
			border:0px solid green;
			width:100%;
			height:30px;
		}
		.div-split{
			height:10px;
			border-bottom:dashed 1px Olive;
		}
		.button-normal{
			height:50px;
			width:60%;
			margin-top:20px;
		}
    </style>
</head>
<body onload="formLoad()">

	

    <div id="scanResult" style="word-break:break-all;padding:20px;width:100%;height:300px;border:1px solid lightgrey;"></div>

    <div style="text-align:center;padding:20px;">
    	<button class="btn btn-success button-normal" id="btnStartScan" onclick="btnStartScan_click();" >开始扫描</button>
		<button class="btn btn-success button-normal" disabled="disabled" id="btnSure" onclick="btnSure_click();">确认接收</button>
	</div>

</body>
</html>
<!-- formLoad -->
<script type="text/javascript">
	var wxTools = null;
	var loaded = false;
	// ------------------------------------------------------------------------
	function formLoad() {
		if(loaded) return;
		var para = {
			serviceKey: "mscm",                     //公众号serviceKey yihaojiaolian
		    appId: "wx9ed3bec99db6511d",                          //公众号appId,wxfbb8102d85b7d2a3 exp
		    isDebug:false   
		}
		wxTools = new window.xwf_weixin(para);
		loaded = true;
	}
	function btnStartScan_click(){
		var scanPara = {
			desc:"请扫描订单二维码...",
			needResult:1,
			success:function(res){
				var result = res.resultStr;
				gId("scanResult").innerHTML = result;
				gId("btnSure").disabled = false;
			}
		};
		wxTools.scanQR(scanPara);
	}
	function btnSure_click(){
		if (gId("scanResult").value != "") {
            var contents = gId("scanResult").value;
            if (g.a.send("processType=g_mscm.i_spd.PO&actionType=poFromScan", { pocontent: contents }, true)) {
                if (g.a.OK) {
                        showMsg("订单发送成功！");
                }
                else {
                    showErr("订单发送失败！请重试");
                }
                gId("scanResult").innerHTML ="";
                gId("btnSure").disabled = true;
            }
        }
	}
</script>

