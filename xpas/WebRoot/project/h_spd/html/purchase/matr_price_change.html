<!DOCTYPE html>
<html>
<head>
    <title>商品价格变更单</title>
	<script src="../../../../res/jscript/xwf.js"></script>
	<script src="../../../../res/jscript/xwf.ajax.js"></script>	
	<script src="../../../../res/jscript/xwf.const.js"></script> 
		
	<script src="../../../../res/control/grid/xwf.grid.js"></script>
	<script src="../../../../res/control/grid/xwf.gridview.js"></script>
	<script src="../../../../res/control/uvform/xwf.uvform.js"></script>

	<script src="../../../../res/jscript/xwf.css.js"></script>
</head>
<body>
	<div id="divDC"></div>
    <div class="PanelA">
	    <form id="frm" action="" target="h_spd.purchase.VIEW_matrPriceChange"> 
		    <table id="tbForm" class="tbForm" style="width:905px;">
			    <tr class="trH">
				    <th style="width:150px;"></th>
				    <th style="width:300px;"></th>
				    <th style="width:150px;"></th>
				    <th style="width:300px;"></th>
			    </tr>			    
			    <tr>
					<td>品名</td>
				    <td class="combo">
						<input type="text" id="_gMaterial_name" readonly="readonly" />
						<div class="fa fa-search" onclick="selectMatr();"></div>
					</td>
					<td>品规</td>
				    <td><input type="text" id="_gMaterial_spec" disabled="disabled" /></td>
			    </tr>
				<tr>				
				    <td>供应商</td>
				    <td><input type="text" id="_gSp_name" disabled="disabled" /></td>
					<td>厂商</td>
				    <td><input type="text" id="_gManufacturer_name" disabled="disabled" /></td>
			    </tr>
				<tr>				
				    <td>单位</td>
				    <td><input type="text" id="_gMaterial_unit" disabled="disabled" /></td>
					<td></td>
				    <td></td>
			    </tr>
				<tr>								    
				    <td><b>计划生效日期</b></td>
				    <td><input type="text" id="_cEffective_date" class="Wdate" onclick="WdatePicker({ dateFmt: 'yyyy-MM-dd' })" /></td>
					<td><b>是否影响历史数据</b></td>
				    <td><input type="checkbox" id="_cValid_for_existing_data" /><label for="_cValid_for_existing_data">更新现存的生效日期(含)之后产生的记帐单</label></td>					
			    </tr>
				<tr>
					<td>首次生效执行时间</td>
				    <td><input type="text" id="_cExec_time1" disabled="disabled" /></td>
				    <td>末次生效执行时间</td>
				    <td><input type="text" id="_cExec_time9" disabled="disabled" /></td>
			    </tr>
				<tr>				
				    <td>HIS代码(旧)</td>
				    <td><input type="text" id="_cMatr_code_his0" disabled="disabled" /></td>
					<td>HIS代码(新)</td>
				    <td><input type="text" id="_cMatr_code_his1" /></td>
			    </tr>
				<tr>				
				    <td>HIS品名(旧)</td>
				    <td><input type="text" id="_cMatr_name_his0" disabled="disabled" /></td>
					<td>HIS品名(新)</td>
				    <td><input type="text" id="_cMatr_name_his1" /></td>
			    </tr>
				<tr>				
				    <td>HIS品规(旧)</td>
				    <td><input type="text" id="_cMatr_spec_his0" disabled="disabled" /></td>
					<td>HIS品规(新)</td>
				    <td><input type="text" id="_cMatr_spec_his1" /></td>
			    </tr>
				<tr>				
				    <td>HIS厂商(旧)</td>
				    <td><input type="text" id="_cMatr_mfg_his0" disabled="disabled" /></td>
					<td>HIS厂商(新)</td>
				    <td><input type="text" id="_cMatr_mfg_his1" /></td>
			    </tr>
				<tr>				
				    <td>供应商价格(旧)</td>
				    <td><input type="text" id="_cPrice_sp0" disabled="disabled" /></td>
					<td><b>供应商价格(新)</b></td>
				    <td><input type="text" id="_cPrice_sp1" /></td>
			    </tr>
			    <tr>
				    <td>备注</td>
				    <td colspan="3"><textarea id="_cRemark" rows="3" cols="0"></textarea></td>
			    </tr>
		    </table>		
		    <input id="_cMATR_PRICE_CHANGE_ID" type="hidden" />
			<input id="_cMATR_ID" type="hidden" />
	    </form>
    </div>
</body>
</html>

<!-- formLoad -->
<script>
	var winMatr = null;
    // ------------------------------------------------------------------------
    function formLoad() {
        vf.css(gId("tbForm"));
    }
</script>

<!-- vf.events -->
<script>
    vf.afterAddnew = function () {
        frm._cEffective_date.value = (new Date).toString();
    }

	vf.afterMove = function () { 
		if (vf.status.equals("view")) {
			frm._gMaterial_name.title = vf.drViewOne["matr_id"].value; 
		}
		else {
			frm._gMaterial_name.title = ""; 
		}
    }	
</script>

<!-- 选择物料 -->
<script>
	function selectMatr() {
		if (winMatr == null) {
			var prop = {
				title: "请选择入库商品...",
				width: 1100,
				height: 0.8,
				parent: win,
				closeMode: "hide"
			};
			var para = {
				viewKey: "matr_for_price_change",
				viewMode: "singleSelect",
				selectCallback: onMatrSelect
			};
			winMatr = topWin.openSelectView(prop, para);
		}
		else {
			winMatr.show();
		}
    }
	function onMatrSelect(dataRow) {
		frm._cMATR_ID.value = dataRow["material_id"].value;

		frm._gMaterial_name.value = dataRow["material_name"].value;
		frm._gMaterial_spec.value = dataRow["material_spec"].value;
        frm._gMaterial_unit.value = dataRow["material_unit"].value;
        frm._gSp_name.value = dataRow["sp_name"].value;
		frm._gManufacturer_name.value = dataRow["manufacturer_name"].value;

		frm._cMatr_code_his0.value = dataRow["material_code_his"].value;
		frm._cMatr_name_his0.value = dataRow["material_name_his"].value;
		frm._cMatr_spec_his0.value = dataRow["material_spec_his"].value;
		frm._cMatr_mfg_his0.value = dataRow["material_firm_id_his"].value;
		frm._cPrice_sp0.value = dataRow["price_sp"].value;        

        frm._cMatr_code_his1.value = dataRow["material_code_his"].value;
        frm._cMatr_name_his1.value = dataRow["material_name_his"].value;
        frm._cMatr_spec_his1.value = dataRow["material_spec_his"].value;
        frm._cMatr_mfg_his1.value = dataRow["material_firm_id_his"].value;
		frm._cPrice_sp1.value = dataRow["price_sp"].value; 

		frm._cPrice_sp1.focus();

		return true;
	}
</script>