<!DOCTYPE html>
<html>
<head>
    <title>授权书缺失查询</title>
	<script src="../../../../res/jscript/xwf.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.ajax.js" type="text/javascript"></script>	
	<script src="../../../../res/jscript/xwf.const.js" type="text/javascript"></script> 
		
	<script src="../../../../res/control/grid/xwf.grid.js" type="text/javascript"></script>
	<script src="../../../../res/control/grid/xwf.gridview.js" type="text/javascript"></script>
	<script src="../../../../res/control/uvform/xwf.uvform.js" type="text/javascript"></script>

	<script src="../../../../res/jscript/xwf.css.js" type="text/javascript"></script>
</head>
<body>
	<div id="divDC"></div>
	<form id="frm" action="" target=""> 
		<table id="tbForm" class="tbForm" style="width:805px;">
			<tr class="trH">
				<th style="width:150px;"></th>
				<th style="width:250px;"></th>
				<th style="width:150px;"></th>
				<th style="width:250px;"></th>
			</tr>
			<tr>				
				<td>供应商：</td>
				<td><input type="text" id="_gCompany_name" value="" /></td>
				<td>品类：</td>
				<td><input type="text" id="_gCfname" value="" /></td>
			</tr>
            <tr>				
				<td>品名：</td>
				<td><input type="text" id="_cMatr_name" value="" /></td>
				<td>品规：</td>
				<td><input type="text" id="_cMatr_spec" value="" /></td>
			</tr>
            <tr>				
				<td>生产厂商：</td>
				<td><input type="text" id="_cManufacturer" value="" /></td> 
			</tr>
		</table>
		<input id="_cMATR_ID" type="hidden" value="" />
        <input id="_cCompany_id" type="hidden" value="" />
        <input id="_gCategory_ids_all" type="hidden" value="" />
	</form>
    <div id="divGrid" style="width:800px;height:260px;"></div> 
</body>
</html>

<!-- formLoad -->
<script type="text/javascript"> 
    var divGrid = gId("divGrid");

    var gridview = null;    
	// ------------------------------------------------------------------------
	function formLoad() {
		vf.css(gId("tbForm"));
	}
</script>

<!-- vf.events -->
<script type="text/javascript"> 
    vf.afterMove = function () {
        var matrId = frm._cMATR_ID.value.toInt();
        var companyId = frm._cCompany_id.value.toInt();        
        var categoryIdsAll = frm._gCategory_ids_all.value;
        var viewFilter = "";
        // ------------------------------------------------
        viewFilter = "cert_category_type = 'A' AND company_id = " + companyId + " AND ("
                   + "cert_id IN(SELECT cert_id FROM T_CERT_MATR WHERE matr_id = " + matrId + " UNION "
                   + "SELECT cert_id FROM T_CERT_MATR_CATEGORY WHERE matr_category_id IN (" + categoryIdsAll + ")))";
        if (gridview == null) {
            var prop = {
                divContainer: divGrid,
                viewKey: "matr_cert_query_a",
                viewFilter: viewFilter,
                viewForm: "project/g_mshare/html/module_name/edit_form.html"
            };
            gridview = new window.xwf_gridview(prop);
        }
        else {
            gridview.setViewFilter(viewFilter);
        }
    }
</script>