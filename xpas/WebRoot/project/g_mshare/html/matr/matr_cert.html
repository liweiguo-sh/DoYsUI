<!DOCTYPE html>
<html>
	<head>
		<title>我的产品资料</title>
		<link href="../../../../res_plugin/bootstrap3.7/bootstrap/css/bootstrap.min.css"	rel="stylesheet" type="text/css" />
		<link href="../../../../res_plugin/bootstrap3.7/bootstrap-table/css/bootstrap-table.css" rel="stylesheet" type="text/css" />

        <script src="../../../../res_plugin/jquery/jquery-3.1.1.min.js" type="text/javascript"></script>
		<script src="../../../../res_plugin/bootstrap3.7/bootstrap-table/js/bootstrap-table.js"	type="text/javascript"></script>
		
        <!--系统框架引用 -->
        <script src="../../../../res/jscript/xwf.js" type="text/javascript"></script>
        <script src="../../../../res/jscript/xwf.ajax.js" type="text/javascript"></script>
        <script src="../../../../res/jscript/xwf.const.js" type="text/javascript"></script>
        <script src="../../../../res/control/window/xwf.window.js" type="text/javascript"></script>
		<script src="../../../../res/control/upload/xwf.upload.js" type="text/javascript"></script>
        <script src="../../js/rstodata.js" type="text/javascript"></script>
		<script src="../../../../res/jscript/xwf.css.js" type="text/javascript"></script>
		<style type="text/css">
			body{
				background-color:lightGray;
			}
			.self-panel-main{
				border:1px solid lightGray;
				width:80%;
				margin-top:20px;
				margin-bottom:20px;
				background-color:White;
				box-shadow: 3px 3px 3px #7F8C8D;
				padding:80px;
			}
			h5{
				color:#7F8C8D;
			}
			th{
				background-color:#3498DB;
				color:White;
				font-size:0.9em;
				text-align:center;
			}
		</style>
	</head>
	<body>
		<div class="container self-panel-main" style="">
			<div class="row"><!--第一行-->
				<div class="col-lg-3">
					<div style="width:100%;height:200px;line-height:200px;text-align:center;border:1px dashed LightGray">
						<img src="" style="width:100%;height:200px;" id="logo" class="img-rounded">
					</div>
					
				</div>
				<div class="col-lg-9">
					<div class="row">
						<div class="col-lg-3"><h3 style="text-align:right">产品名称：</h3></div>
						<div class="col-lg-5"><h3 style="text-align:left" id="_cmatr_name">华润医药商业有限公司</h3></div>
					</div>
					<div class="row">
						<div class="col-lg-2"><h5 style="text-align:right">产品分类：&nbsp;&nbsp;</h5></div>
						<div class="col-lg-4"><h5 style="text-align:left" id="_ccategory_name">910587P8UTRE874</h5></div>
						<div class="col-lg-2"><h5 style="text-align:right">规格：&nbsp;&nbsp;</h5></div>
						<div class="col-lg-4"><h5 style="text-align:left" id="_cmatr_spec">910587P8UTRE874</h5></div>
					</div>
					<div class="row">
						<div class="col-lg-2"><h5 style="text-align:right">剂型：&nbsp;&nbsp;</h5></div>
						<div class="col-lg-4"><h5 style="text-align:left" id="_cmatr_dosage">李小二</h5></div>
						<div class="col-lg-2"><h5 style="text-align:right">注册证效期：&nbsp;&nbsp;</h5></div>
						<div class="col-lg-4"><h5 style="text-align:left" id="_cregister_exp">李小二</h5></div>
					</div>
					
					<div class="row">
						<div class="col-lg-2"><h5 style="text-align:right">创建人：&nbsp;&nbsp;</h5></div>
						<div class="col-lg-4"><h5 style="text-align:left" id="_ccreator">138*****1122</h5></div>
						<div class="col-lg-2"><h5 style="text-align:right">创建日期：&nbsp;&nbsp;</h5></div>
						<div class="col-lg-4"><h5 style="text-align:left" id="_ccdate">138*****1122</h5></div>
					</div>
					<div class="row">
						<div class="col-lg-2"><h5 style="text-align:right">生产厂家：&nbsp;&nbsp;</h5></div>
						<div class="col-lg-6"><h5 style="text-align:left" id="_cmanufacturer_name">上海市静安区彭江路1188号</h5></div>
					</div>
				</div>  
				   
			</div><!--第一行.结束-->
			<br />
			<br />
			<br />
			<div class="row"><!--第2行-->
				<h2><i class="fa fa-info-circle"></i>&nbsp;&nbsp;产品资料</h2>
				<div style="width:100%;height:5px;background-color:lightGray;"></div>
			</div><!--第2行.结束-->
			<div class="row"><!--第3行-->
				<div id="toolbar">
					<button id="btnLoad" class="btn btn-default">添加资质</button>
				</div>
				<table id="tbMatrDocs" data-toggle="table" data-toolbar="#toolbar" data-height="500" 
					data-sort-name="cert_name"
					data-sort-order="desc"
					data-pagination="true"
					data-search="true"
					data-page-size="10"
					data-page-list="[10,20,30]"
					kk_data-url="../json/data1.json">
					<thead>
						<tr>
							<th  style="width:10%" data-field="no">序</th>
							<th  style="width:50%" data-field="cert_name"  data-sortable="true">资质名称</th>
							<th  style="width:10%" data-field="creator">创建者</th>
							<th  style="width:20%" data-field="cdate"  data-sortable="true">创建时间</th>
							<th  style="width:10%" data-field="cert_version">版本</th>
							<th  style="width:10%" data-field="operate">操作</th>
						</tr>
					</thead>
				</table>
			</div><!--第3行.结束-->
		</div>
	</body>

</html>
<script type="text/javascript">
    var $table = $('#tbMatrDocs'),
		$button = $('#btnLoad');
    var mmid= null;
	$(function () {
	    mmid = win.para.primaryKey.split(",")[1]  ;
	    editdata();
		
	});
	function editdata(){
	    if (g.a.send("processType=g_mshare.base.certMaterial&actionType=getMatrCert", {   "viewKey": "receive","my_matr_id":mmid}, true)) {
             if (g.a.OK) {
                matrrs=g.a.cReturn.matrrs
                matrcertrs=g.a.cReturn.matrcertrs
                fillcom(matrrs);
                fillcomcert(matrcertrs);
             }
             else {
                return false;
            }
        }
	}
	
	function fillcom(rs){
	var row=rs.rows[0];
	$("#_cmatr_name").html(row['matr_name'].value);
	$("#_ccategory_name").html(row['category_name'].value);
	$("#_cmatr_spec").html(row['matr_spec'].value);
	$("#_cmatr_dosage").html(row['matr_dosage'].value);
	$("#_cregister_exp").html(row['register_exp'].value);
    $("#_ccreator").html(row['creator'].value);
	$("#_ccdate").html(row['cdate'].value);
	$("#_cmanufacturer_name").html(row['manufacturer_name'].value);
	$("#logo").attr('src',row['company_logo'].value);
	}
	
   function fillcomcert(rs){
   
      for(var i=0;i<rs.rowCount;i++){
          if (rs.rows[i]['operate'].value.equals("-1")) {
              rs.rows[i]['operate'].value = " &nbsp;&nbsp;<i class='fa fa-magic' style='color:#2980B9;cursor:pointer' ><span onclick='edit1(" + rs.rows[i]['my_cert_id'].value + ")'>更新</span></i>";
          } else  if (rs.rows[i]['operate'].value.equals("1")){
              rs.rows[i]['operate'].value = "&nbsp;&nbsp;<i class='fa fa-magic' style='color:#2980B9;cursor:pointer' ><span onclick='edit2(" + rs.rows[i]['my_cert_id'].value + ")'>更新</span></i>";
          }else{
             rs.rows[i]['operate'].value = "<i class='fa fa-close'  style='color:#E74C3C;cursor:pointer' ><span   onclick='del(" + rs.rows[i]['my_cert_id'].value + ")'>删除</span></i> &nbsp;&nbsp;<i class='fa fa-edit' style='color:#2980B9;cursor:pointer' ><span onclick='edit2(" + rs.rows[i]['my_cert_id'].value + ")'>修改</span></i>";
          }
      }
      var rows = todatatable(rs);
      $table.bootstrapTable('load', rows);
	}
	function edit1(index) {
		var para = {
				flowKey: "",
				viewKey: "",
				isAddnew: false,
				primaryKey: "my_cert_id," + index,
				etype:1,
				callback:callback

			};
			var prop = {
				text: "资质信息",
				url: g.appPath + "project/g_mshare/html/company/cert_edit.html"
			};
				top.topWin.openFullWindow(prop, para);
			
	}
   function edit2(index) {
		var para = {
				flowKey: "",
				viewKey: "",
				isAddnew: false,
				primaryKey: "my_cert_id," + index,
				etype:2,
				callback:callback

			};
			var prop = {
				text: "资质信息",
				url: g.appPath + "project/g_mshare/html/company/cert_edit.html"
			};
				top.topWin.openFullWindow(prop, para);
			
	}

	function callback(){
	 editdata();
	}

	function del(index) {

		alert("del:"+index);
	}
	function edit(index) {

		alert("eidt:"+index);
	}
</script>