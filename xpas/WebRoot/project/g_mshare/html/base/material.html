<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>新增产品</title>
    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="http://apps.bdimg.com/libs/jquery/1.11.1/jquery.min.js"></script>
    <!-- 新 Bootstrap 核心 CSS 文件 -->
    <link href="http://apps.bdimg.com/libs/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="http://apps.bdimg.com/libs/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <link href="../../../../res_plugin/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet"
        type="text/css" />
    <!-- IE8支持HTML5 文件 -->
    <script src="http://apps.bdimg.com/libs/html5shiv/3.7/html5shiv.min.js"></script>
    <script src="http://apps.bdimg.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <!---->
    <script src="../../../../res/jscript/xwf.js" type="text/javascript"></script>
    <script src="../../../../res/jscript/xwf.ajax.js" type="text/javascript"></script>
    <script src="../../../../res/jscript/xwf.const.js" type="text/javascript"></script>
    <script src="../../../../res/jscript/xwf.datatable.js" type="text/javascript"></script>
    <script src="../../../../res/control/tab/xwf.tab.js" type="text/javascript"></script>
    <script src="../../../../res/control/tree/xwf.tree.js" type="text/javascript"></script>
    <script src="../../../../res/control/grid/xwf.grid.js" type="text/javascript"></script>
    <script src="../../../../res/control/grid/xwf.gridview.js" type="text/javascript"></script>
    <script src="../../../../res/control/toolbar/xwf.toolbar.js" type="text/javascript"></script>
    <script src="../../../../res/control/uvform/xwf.uvform.js" type="text/javascript"></script>
    <script src="../../../../res/jscript/xwf.css.js" type="text/javascript"></script>
    <script src="../../../../res_plugin/util/chinese_py.js" type="text/javascript"></script>
    <style type="text/css">
        body
        {
            background-color: GhostWhite;
            padding-left: 250px;
        }
        a
        {
            color: #3498DB;
            cursor: pointer;
        }
        a:hover
        {
            color: #2980B9;
        }
        .self-panel-main
        {
            margin: 0 20px 0 20px;
            background-color: White;
            box-shadow: 3px 3px 3px #888888;
            padding: 80px;
        }
        .self-panel-nav
        {
            margin-top: 20px;
            margin-left: auto;
            margin-right: auto;
            width: 60%;
            border: 0px solid green;
        }
        .self-nav-inactive
        {
            color: DarkGray;
            font-size: 1.5em;
        }
        .self-nav-active
        {
            color: #3498DB;
            font-size: 1.8em;
        }
        .div-title
        {
            font-size: 1.3em;
            font-family: 微软雅黑;
            color: #3498DB;
            width: 100%;
            border-bottom: 1px solid #3498DB;
        }
        .div-input-info
        {
            font-size: 0.9em;
            font-family: 微软雅黑;
            color: #2C3E50;
            width: 50%;
            margin-left: 100px;
            margin-top: 50px;
        }
        .div-cert
        {
            width: 100%;
            margin-bottom: 50px;
        }
        .div-cert td
        {
            text-align: center;
            border: 0px solid red;
        }
        .td-field-title
        {
            text-align: right;
            padding-right: 15px;
        }
        .td-field-content
        {
            text-align: left;
            padding-bottom: 10px;
            padding-top: 10px;
            height: 50px;
        }
        .input-field-content
        {
            height: 30px;
            border: 1px solid LightGray;
            background-color: GhostWhite;
            color: #7F8C8D;
            padding-left: 5px;
        }
        .chk-field-content
        {
            cursor: pointer;
        }
        .img-cert
        {
            width: 200px;
            height: 150px;
            text-align: center;
            font-size: 0.8em;
        }
    </style>
</head>
<body>
    <div class="self-panel-main" style="height: 1500px;">
        <!--区域1 -->
        <div class="div-title" style="border: 0px;">
            基本信息</div>
        <div class="div-title">
        </div>
        <div class="div-input-info">
            <table style="width: 100%">
                <tr>
                    <th style="width: 150px;">
                    </th>
                    <th>
                    </th>
                </tr>
                <tr>
                    <td class="td-field-title">
                        分类 ：
                    </td>
                    <td class="td-field-content combo">
                        <input type="text" class="input-field-content" style="width: 50%" id="_gcategory_name" /><div
                            id="btnSelectCatagory" class="fa fa-search" onclick="btnSelectCatagory_click();">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="td-field-title">
                        注册名称 ：
                    </td>
                    <td class="td-field-content">
                        <input type="text" class="input-field-content" style="width: 100%" id="_cMatr_name"
                            onchange="onMaterialNameChanged(this);" />
                    </td>
                </tr>
                <tr>
                    <td class="td-field-title">
                        商品名 ：
                    </td>
                    <td class="td-field-content">
                        <input type="text" class="input-field-content" style="width: 100%" id="_cMatr_trade_name"
                            onchange="onMaterialNameChanged1(this);" />
                    </td>
                </tr>
                <tr>
                    <td class="td-field-title">
                        规格 ：
                    </td>
                    <td class="td-field-content">
                        <input type="text" class="input-field-content" style="width: 50%" id="_cMatr_spec" />
                    </td>
                </tr>
                <tr>
                    <td class="td-field-title">
                        单位 ：
                    </td>
                    <td class="td-field-content">
                        <input type="text" class="input-field-content" style="width: 30%" id="_cMatr_unit" />
                    </td>
                </tr>
            </table>
        </div>
        <!--区域1 结束-->
        <!--区域2-->
        <div class="div-title" style="border: 0px;">
            厂商及注册证</div>
        <div class="div-title">
        </div>
        <div class="div-input-info">
            <table style="width: 100%">
                <tr>
                    <th style="width: 150px;">
                    </th>
                    <th>
                    </th>
                </tr>
                <tr>
                    <td class="td-field-title">
                        生产厂商 ：
                    </td>
                    <td class="td-field-content">
                        <input type="text" class="input-field-content" style="width: 100%" id="_cManufacturer_name" />
                    </td>
                </tr>
                <tr>
                    <td class="td-field-title">
                        注册证号 ：
                    </td>
                    <td class="td-field-content">
                        <input type="text" class="input-field-content" style="width: 30%" id="_cRegister_no" />
                    </td>
                </tr>
                <tr>
                    <td class="td-field-title">
                        注册证有效期 ：
                    </td>
                    <td class="td-field-content">
                        <input type="text" class="input-field-content Wdate" style="width: 30%" id="_cRegister_exp"
                            onclick="WdatePicker()" />
                    </td>
                </tr>
            </table>
        </div>
        <!--区域2 结束-->
        <!--区域3-->
        <div class="div-title" style="border: 0px;">
            产品资料</div>
        <div class="div-title">
        </div>
        <div class="div-input-info">
            <div class="div-cert">
                <div style="margin-bottom: 20px; width: 100%; text-align: center; font-size: 1em;
                    font-family: 微软雅黑; color: #2C3E50;">
                    --注册证--</div>
                <table style="width: 100%">
                    <tr>
                        <td>
                            <img src="" style="width: 200px; height: 150px; border: 1px solid LightGray;" alt="暂无图片" /><br />
                            <button class="btn btn-primary" style="width: 80px; margin-top: 5px;">
                                选择文件</button>
                        </td>
                        <td>
                            <img src="../../images/upload-example/company-license.png" style="width: 200px; height: 150px;
                                border: 1px dashed LightGray;" /><br />
                            <button class="btn btn-primary" style="width: 80px; margin-top: 5px;" disabled="disabled">
                                样例</button>
                        </td>
                    </tr>
                </table>
            </div>
            <div class="div-cert">
                <div style="margin-bottom: 20px; width: 100%; text-align: center; font-size: 1em;
                    font-family: 微软雅黑; color: #2C3E50;">
                    --厂商授权书--</div>
                <table style="width: 100%">
                    <tr>
                        <td>
                            <img src="" style="width: 200px; height: 150px; border: 1px solid LightGray;" alt="暂无图片" /><br />
                            <button class="btn btn-primary" style="width: 80px; margin-top: 5px;">
                                选择文件</button>
                        </td>
                        <td>
                            <img src="../../images/upload-example/company-auth.png" style="width: 200px; height: 150px;
                                border: 1px dashed LightGray;" /><br />
                            <button class="btn btn-primary" style="width: 80px; margin-top: 5px;" disabled="disabled">
                                样例</button>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="div-title">
        </div>
        <div class="div-title" style="text-align: center; border: 0">
            <button id="submitmrt" class="btn btn-success" style="width: 200px; margin-top: 25px;">
                确认提交</button></div>
    </div>
    <div id="divDC" class="ScreenCenter" style="display: none; width: 1000px">
    </div>
    <form id="frm" action="" target="g_mshare.base.product">
    <table id="tbForm" class="tbForm" style="width: 1205px;">
        <tr id="trH">
            <th style="width: 150px;">
            </th>
            <th style="width: 250px;">
            </th>
            <th style="width: 150px;">
            </th>
            <th style="width: 250px;">
            </th>
            <th style="width: 150px;">
            </th>
            <th style="width: 250px;">
            </th>
        </tr>
    </table>
    <input type="hidden" id="_cmatr_id" />
    <input type="hidden" id="_cCompany_id" />
    <input type="hidden" id="_ccategory_id" />
    <input type="hidden" id="_cmatr_name_py" />
    <input type="hidden" id="_cmatr_trade_name_py" />
    </form>
</body>
</html>
<script type="text/javascript">
    var pWin = null;
    function formLoad() {
        pWin = win.parentWindow;
        win.addEventListener("afterClose",
			function () {
			    if (win.para.callback) {
			        win.para.callback();
			    }
			}
		);
    }

    function onMaterialNameChanged(obj) {
        var py = makePy(obj.value);
        if (py.length > 1) {
            showMsg("请留意名称中的多音字并校正拼音码！");
        }
        frm._cmatr_name_py.value = py[0].substring(0, 10);
    }
    function onMaterialNameChanged1(obj) {
        var py = makePy(obj.value);
        if (py.length > 1) {
            showMsg("请留意名称中的多音字并校正拼音码！");
        }
        frm._cmatr_trade_name_py.value = py[0].substring(0, 10);
    }

    function btnSelectCatagory_click() {
        var prop = {
            title: "请选择分类...",
            parent:win
        };
        var para = {
            viewKey: "mart_category_chose",
            viewForm: g.appPath + "project/g_mshare/html/base/mart_category_chose.html",
            selectCallback: callbackSelectOperation,
            callbackPara: {}
        };
        topWin.openSelectView(prop, para);
    }

    function callbackSelectOperation(drRow) {
        gId("_gcategory_name").value = drRow.category_name.value;
        gId("_ccategory_id").value = drRow.mart_category_id.value;
        return true;
    }

    $("#submitmrt").click(function () {
        if (!vf.status.equals("addnew")) {
            vf.save();
            return true;
        }

        var categoryId = $("#_ccategory_id").val();
        var martName = $("#_cMatr_name").val();
        var martTradeName = $("#_cMatr_trade_name ").val();
        var spec = $("#_cMatr_spec").val();
        var unit = $("#_cMatr_unit").val();
        var manufactureName = $("#_cManufacturer_name").val();
        var regNo = $("#_cRegister_no").val();
        var regexp = $("#_cRegister_exp").val();
        var companyId = $("#_cCompany_id").val();


        var jsonPara = {
            categoryId: categoryId,
            martName: martName,
            martTradeName: martTradeName,
            spec: spec,
            unit: unit,
            manufactureName: manufactureName,
            regNo: regNo,
            regexp: regexp,
            companyId: companyId,
            viewKey: "mart_category"
        };
        if (g.a.send("processType=g_mshare.base.product&actionType=productReg", jsonPara, true)) {
            if (g.a.OK) {
                var cReturn = g.a.cReturn;
                var result = cReturn.msg;
                if (result.equals("success")) {
                    alert("注册成功！");
                    win.close();
                } else {
                    alert("遇到意外错误！");
                }
            }
        }

    });
    
</script>
