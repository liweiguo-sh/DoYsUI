<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>品类定义</title>
	<script src="../../../../res/jscript/xwf.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.ajax.js" type="text/javascript"></script>	
	<script src="../../../../res/jscript/xwf.const.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.datatable.js" type="text/javascript"></script>
	<script src="../../../../res/control/uvform/xwf.uvform.js" type="text/javascript"></script>

	<script src="../../../../res/jscript/xwf.css.js" type="text/javascript"></script>
</head>
<body>
	<div id="divDC"></div>
	<form id="frm" action="" target="g_mshare.base.mart_Category">
		<table id="tbForm" class="tbForm" style="width:1020px;height:200px">
			<tr class="trH">
				<th style="width:130px;"></th>
				<th style="width:180px;"></th>
				<th style="width:130px;"></th>
				<th style="width:180px;"></th>
			</tr>
			<tr>
				<td>品类名称：</td>
				<td><input id="_cCategory_name" type="text" value="" /></td>
				<td>品类代码：</td>
				<td><input id="_cCategory_code" type="text" value="" /></td>
			</tr>
			
			<tr>
				<td>序号：</td>
				<td><input id="_cCategory_order" type="text" value="" /></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>完整名称：</td>
				<td colspan="3"><input id="_gCategory_fullname" type="text" disabled="disabled" /></td>
			</tr>
			<tr>
				<td>备注：</td>
				<td colspan="3"><textarea id="_cCategory_remark" rows="3" cols="0"></textarea></td>
			</tr>
		</table>
		<input type="hidden" id="_cCategory_id_parent" value="" />
		<input type="hidden" id="_cMart_category_id" value="" />
		<input type="hidden" id="_cNode_Key" value="" />
		<input type="hidden" id="_cCategory_fullname" value="" />
		<input type="hidden" id="_cCategory_full_order" value="" />
        <input type="hidden" id="_cCompany_id" value="" />
		<input type="hidden" id="_xPNode_Key" value="" />
	</form>
</body>
</html>

<!-- formLoad -->
<script type="text/javascript">
	var node = null;
	// ----------------------------------------------------
	function formLoad() {
		vf.css(gId("tbForm"));
	}
</script>

<script type="text/javascript">
vf.afterMove = function () {
    node = win.parentWindow.gridView.tree.selectedNode;
}
   vf.beforeAddnew = function () {
        node = win.parentWindow.gridView.tree.selectedNode;
        if (node == null) {
            showErr("请选中一个区域节点！");
            return false;
        }
        return true;
    }
    
	vf.afterAddnew = function () {
		frm._cCategory_order.value = "999";
		frm._cCategory_id_parent.value = node.value;
	};

	vf.beforeSave = function () {
		if (vf.status.equals("addnew")) {
			frm._xPNode_Key.value = node.nodeKey;
		}
		if (frm._cCategory_order.value.toInt() < 0 || frm._cCategory_order.value.toInt() > 999) {
			showErr("序号范围为 0 - 999 之间。");
			return false;
		}
		return true;
	};
	vf.afterSave = function () {
		     if (node) {
            win.parentWindow.gridView.tree.reloadNode(node);
        }
	};
	vf.afterDelete = function () {
	     if (node) {
            win.parentWindow.gridView.tree.reloadNode(node); 
        }
	}

</script>