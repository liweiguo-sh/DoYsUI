<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>资质维护</title>
	<link href="../../../../res_plugin/bootstrap3.7/bootstrap/css/bootstrap.min.css"   rel="stylesheet" type="text/css" />
	<link href="../../../../res_plugin/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

    <script src="../../../../res_plugin/jquery/jquery-3.1.1.min.js" type="text/javascript"></script>
    <script src="../../../../res_plugin/bootstrap3.7/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>

	
	<!-- 日期选择 -->
	<link href="../../../../res_plugin/bootstrap3.7/dtpicker/css/bootstrap-datetimepicker.min.css" rel="stylesheet" type="text/css" />
	<script src="../../../../res_plugin/bootstrap3.7/dtpicker/js/bootstrap-datetimepicker.min.js"	type="text/javascript"></script>
	<script src="../../../../res_plugin/bootstrap3.7/dtpicker/js/locales/bootstrap-datetimepicker.zh-CN.js"	type="text/javascript"></script>

	<script src="../../../../res/jscript/xwf.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.ajax.js" type="text/javascript"></script>	
	<script src="../../../../res/jscript/xwf.const.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.datatable.js" type="text/javascript"></script>
    <script src="../../../../res/control/toolbar/xwf.toolbar.js" type="text/javascript"></script>
	<script src="../../../../res/control/uvform/xwf.uvform.js" type="text/javascript"></script>
	<script src="../../../../res/control/upload/xwf.upload.js" type="text/javascript"></script>
	<script src="../../../../res/control/upload/xwf.upload_core.js" type="text/javascript"></script>
	<link href="../../../../res/control/upload/style3/xwf.upload.css" rel="stylesheet"
		type="text/css" />
	<script src="../../js/doc_center.js" type="text/javascript"></script>
	
</head>
<body>
	<div id="divDC" style="display:none"></div>
	<div style="width:800px;margin:20px 0px 20px 50px;">
		
		<form id="frm" role="form" action="" target="g_mshare.base.Cert">
			<div class="form-group">
				<label for="_cCert_name">资质名称</label>
				<input type="text" class="form-control" id="_cCert_name" placeholder="请输入名称" style = "width:50%;"/>
			</div>
			<div class="form-group">
				<label for="_cCert_code">资质号码</label>
				<input type="text" class="form-control" id="_cCert_code" placeholder="请输入资质的号码" style = "width:50%;"/>
			</div>
			<div class="form-group">
				<label for="_cCert_version">版本号</label>
				<input type="text" class="form-control" id="_cCert_version" style="width:100px;" disabled="disabled"/>
			</div>
			<div class="form-group">
				<label for="exp_date">有效期</label>
				<div class="input-group date" id="exp_date" data-date="" data-date-format="yyyy-mm-dd" style="width:200px;">
                    <input class="form-control" size="16" type="text" id="_cCert_exp" />
					<span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                </div>
			</div>
			
			<input type="hidden" id="_cCert_id" value="" />
			<input type="hidden" id="_cCert_doc_id" value="" />
			<input type="hidden" id="_cCompany_id" value="" />
			<input type="hidden" id="_cCert_category_id" value="" />
			<input type="hidden" id="_cCert_status_ref" value="" />
		</form>
		<div>
			<label for="divCertUpload">附件</label>
			<div id="divCertUpload" style="width:100%;height:300px;border:0px solid green"></div>
		</div>
		<div style="width:100%;text-align:center;">
			<button type="button" class="btn btn-success" id="btnSave" onclick="btnSave_click();" style="width:150px;">保存</button>
			<button type="button" class="btn btn-warning" id="btnClose" onclick="win.close();" style="width:150px;display:none">关闭</button>
		</div>
	</div>
</body>
	
</html>

<!-- formLoad -->
<script type="text/javascript">
	// ----------------------------------------------------
	$(document).ready(function () {
		$('#exp_date').datetimepicker({
			language: "zh-CN",
			weekStart: 1,
			todayBtn: 1,
			autoclose: 1,
			todayHighlight: 1,
			startView: 2,
			minView: 2,
			forceParse: 0,
			initialDate: (new Date()).toString("yyyy-MM-dd")
		});

	});
	function formLoad() {
		if (win.para.readonly) {
			gId("btnSave").style.display = "none"
			gId("btnClose").style.display = ""
		}
	}

	vf.afterAddnew = function () {
		frm._cCert_doc_id.value = 0;
		if (win.para.docPara) {
			var docPara = win.para.docPara;
			frm._cCompany_id.value = docPara.companyId;
			frm._cCert_category_id.value = docPara.certCategoryId;
			frm._cCert_name.value = docPara.certName;
			frm._cCert_version.value = docPara.certVersion;
		}
		return true;
	}
	vf.afterMove = function () {
	    if (win.para.docPara) {
	        frm._cCert_version.value = win.para.docPara.certVersion;
        }
	    var upA = docService.createUploadArea({
	        divContainer: gId("divCertUpload"),
	        docId: frm._cCert_doc_id.value.toInt(),
	        certCategoryId: frm._cCert_category_id.value.toInt(),
	        showTitle: false,
	        showNotes: true,
	        allowView: false,
	        showSign: true,
	        showRemove: true,
	        showDownload: false,
	        readonly: win.para.readonly,
	        afterDocSave: afterDocSave
	    });
	}
	function btnSave_click() {
		vf.save();
		if (win.para.afterClose) {
			win.para.afterClose(win.para.docPara,frm._cCert_id.value.toInt());
		}
		win.close();
	}
	function afterDocSave(ctl) {
		frm._cCert_doc_id.value = ctl.docId;
		debug("文档:" + frm._cCert_doc_id.value + "-saved!");
	}
</script>
