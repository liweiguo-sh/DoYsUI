<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>标签打印</title>
	<script src="../../../../res/jscript/xwf.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.ajax.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.const.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.datatable.js" type="text/javascript"></script>

	<script src="../../../../res/jscript/xwf.css.js" type="text/javascript"></script>
</head>
<body scroll="no">
	<div id="divOperateButtons" class="divButtons" style="margin-bottom:10px;">
		<input type="button" id="btnClose" value="关闭" onclick="btnClose_click();" />
		<input type="button" id="btnSetVarValue" value="标签元素赋值" onclick="btnSetVarValue_click();" />
		<input type="button" id="btnPrint" value="打印标签" onclick="btnPrint_click();" style="color:Red;font-weight:bold;" />		
	</div>
	<div id="divTab" class="xwf_tab_divContainer" style="width:600px;height:480px;">
		<object id="canvas" classid="CLSID:827DF6D2-DD6F-4d97-8C7F-5C19E15CE30D" width="600px" height="480px" disabled="disabled">
			未安装标签预览控件，请到登录页面下载并安装标签控件。
		</object>
	</div>
</body>
</html>

<!-- formLoad -->
<script type="text/javascript">
	var labelId = 0;	
	var cvs = gId("canvas");	
	// ----------------------------------------------------
	function formLoad() {
		labelId = win.para.labelId;

		initLabel();
	}

	function btnClose_click() {
		win.close();
	}
</script>

<!-- 加载标签 -->
<script type="text/javascript">
	function initLabel() {
		if (g.a.send("processType=example.training5_label.LabelFile&actionType=getLabelFileById", { labelId: labelId }, true)) {
			if (g.a.OK) {
				var cReturn = g.a.cReturn;
				var dtbLabel = cReturn.dtbLabel;
				var xmlContent = dtbLabel.rows[0]["label_file"].value;

				cvs.OpenXML(xmlContent);
				cvs.ZoomToFit();
				cvs.ZoomToFit();
			}
			else {
				return false;
			}
		}
		else {
			return false;
		}
	}
</script>
<!-- 赋值打印 -->
<script type="text/javascript">
	function btnSetVarValue_click() {
		cvs.SetVarValue("标签元素1", "12345678");
		cvs.SetVarValue("标签元素2", "87654321");
		cvs.RePaint();
	}

	function btnPrint_click() {
		cvs.PrintOut();
	}
</script>