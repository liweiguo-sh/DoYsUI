<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>存货量图表</title>
	<script src="../../../../res/jscript/xwf.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.ajax.js" type="text/javascript"></script>	
	<script src="../../../../res/jscript/xwf.const.js" type="text/javascript"></script>	
	<script src="../../../../res/jscript/xwf.datatable.js" type="text/javascript"></script>

	<script src="../../../../res_plugin/echarts/echarts.min.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.css.js" type="text/javascript"></script>

	<style type="text/css">
		.tbLayout {
			width: 100%;
			table-layout: fixed;
			border-collapse: collapse;
		}
		.tdLayout {
			width: 50%;
			padding: 0px;
			border: 1px solid Olive;
		}
		.tdTitle {
			padding: 10px 0px 5px 0px;
		}

		.divChart {
			height: 500px;
			border: 0px solid Red;
		}

		.selectChartStyle {
			width: 35%;
			height: 30px;
		}
	</style>
</head>
<body>
	<div id="divButton" class="divButtons">
		<input type="button" id="btnChart1" onclick="btnChart1_click();" value="柱状图/折线图" />
		<input type="button" id="btnClose" onclick="btnClose_click();" value="关闭" />
	</div>
	<table class="tbLayout">
		<tr>
			<td class="tdTitle">
				<select id="selChartStyle1" class="selectChartStyle">
					<option value="bar">柱状图</option>
					<option value="line">折线图</option>					
				</select>
			</td>
			<td class="tdTitle">
			</td>
		</tr>
		<tr>
			<td class="tdLayout">
				<div id="divChart1" class="divChart"></div>
			</td>
			<td class="tdLayout">
				<div id="divChart2" class="divChart"></div>
			</td>
		</tr>
	</table>
</body>
</html>

<!-- formLoad -->
<script type="text/javascript">
	var divChart1 = gId("divChart1");
	var divChart2 = gId("divChart2");

	var chart1 = null, chart2 = null;
	// ------------------------------------------------------------------------
	function formLoad() {

	}

	function btnClose_click() {
		win.close();
	}
</script>

<!-- 生成图表(柱状图/折线图) -->
<script type="text/javascript">
	function btnChart1_click() {
		if (g.a.send("processType=example.training3.Chart&actionType=getChart1", {}, true)) {
			if (g.a.OK) {
				var cReturn = g.a.cReturn;
				var dtbData = cReturn.dtbChartData;
				loadChart1(dtbData);
			}
			else {
				return false;
			}
		}
		else {
			return false;
		}
	}
	function loadChart1(dtbData) {
		var arrDataX = new Array();
		var arrDataS = new Array();

		for (var i = 0; i < dtbData.rowCount; i++) {
			arrDataX.push(dtbData.rows[i]["product_name"].value);
			arrDataS.push(dtbData.rows[i]["stock_qty"].value);
		}

		var option = {
			title: {
				text: "库存量分布图"
			},
			tooltip: {
				show: true
			},
			legend: {
				data: ['库存数量']
			},
			xAxis: [
                {
                	type: 'category',
                	data: arrDataX
                }
            ],
			yAxis: [
                {
                	type: "value"
                }
            ],
			series: [
                {
                	"name": "库存数量",
                	"type": gId("selChartStyle1").value,
                	"data": arrDataS
                }
            ]
		};

		chart1 = echarts.init(gId("divChart1"));
		chart1.setOption(option);
	}
</script>