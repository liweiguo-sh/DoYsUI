<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>文件上传窗口</title>
	<script src="../../../../res/jscript/xwf.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.ajax.js" type="text/javascript"></script>	
	<script src="../../../../res/jscript/xwf.const.js" type="text/javascript"></script>

	<script src="../../../../res/jscript/xwf.css.js" type="text/javascript"></script>
	<style type="text/css">
		table {
			table-layout: fixed;
			border-collapse: collapse;
			margin: 10px 10px 20px 0px;
		}
		table td {
			padding: 0px;
		}
		input[type='file'] {
			width: 300px;
			height: 24px;
		}
	</style>
</head>
<body>
	<div id="divButtons" class="divButtons">
		<input type="button" id="btnOK" value="确定选择" onclick="btnOK_click();" />
		<input type="button" id="btnClose" value="关闭" onclick="btnClose_click();" />
	</div>
	<form id="frmUpload" action="" target="">
		<table>
			<tr>
				<td><input type="file" id="file1" name="file1" onchange="doOK();" /></td>
			</tr>
		</table>		
	</form>
</body>
</html>

<!-- formLoad -->
<script type="text/javascript">
	// ------------------------------------------------------------------------
	function formLoad() {
		setTimeout("autoShow();", 200);
	}

	function btnClose_click() {
		win.close();
	}
</script>
<!-- select file -->
<script type="text/javascript">
	function btnOK_click() {
		if (gId("file1").value.equals("")) {
			showWarn("请先选择文件。");
			return;
		}
		doOK();
	}
	function autoShow() {
		if (g.b.ie && g.b.ie <= 8) {
			gId("file1").click();
		}
		else {
			gId("file1").click();
		}
	}
	function doOK() {
		var uploadAction = "";
		var extName = "";
		var filename = gId("file1").value;
		// ------------------------------------------------
		if (!filename.equals("")) {
			if (win.para.callback) {
				win.hide();
				win.para.callback({ filename: filename });
			}
			else {
				showErr("缺少回调函数(callback)，请检查。");
			}
		}
		win.close();
	}
</script>
