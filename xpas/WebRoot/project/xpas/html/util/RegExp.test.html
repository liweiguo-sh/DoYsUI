<!DOCTYPE html />
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>正则表达式测试窗口</title>
	<link href="../../../../res_plugin/bootstrap4.0/my_bootstrap/bootstrap.min.css" rel="stylesheet" type="text/css" />
	<script src="../../../../res_plugin/bootstrap4.0/my_bootstrap/jquery-3.2.1.slim.min.js" type="text/javascript"></script>
	<script src="../../../../res_plugin/bootstrap4.0/my_bootstrap/popper.min.js" type="text/javascript"></script>
	<script src="../../../../res_plugin/bootstrap4.0/my_bootstrap/bootstrap.min.js" type="text/javascript"></script>
	
	<script src="../../../../res/jscript/xwf.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.ajax.js" type="text/javascript"></script>	
	<script src="../../../../res/jscript/xwf.const.js" type="text/javascript"></script>
</head>
<body>
	<div class="container-fluid" style="width:1200px;">
		<h1>&nbsp;</h1>
		<h4>正则表达式测试</h4> 
		<div class="card card-primary">
			<div class="card-header bg-primary text-white">测试区</div>
			<div class="card-body">
				<div class="row" id="divRow1">
					<div class="col-sm-5">
						<label for="txtPattern">模式 pattern</label>
						<input type="text" id="txtPattern" class="form-control" placeholder="请输入正则表达式" onkeyup="txtPattern_keypress();">
						<br />
						<label for="txtString">测试内容 string</label>
						<input type="text" id="txtString" class="form-control" placeholder="请输入测试内容" onkeyup="txtString_keypress();">
						<div id="divInvalid" class="invalid-feedback">验证失败</div>
						<br />
						<div class="form-check">
							<label class="form-check-label">
								<input id="chkAuto" class="form-check-input" type="checkbox" value="">
								自动测试 Auto test
							</label>
						</div>
						<br />
						<div class="col-sm-12 text-center">						
							<a href="#" id="btnTest" class="btn btn-primary" style="width:30%;" onclick="btnTest_click();">测试</a>							
						</div>
					</div>
					<div class="col-sm-7">
						<div id="divResult" class="jumbotron alert-secondary" style="margin-top:15px;padding-top:15px;">
							常用正则表达式：
							<ul>
								<li>纯数字字符串：^[0-9]+$</li>
								<li>手机号码：^1\d{10}$</li>
								<li>电子邮箱：^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$</li>
								<li>身份证号码(18位简单验证，未验证校验位)：^\d{17}(\d|X|x)$</li>
								<li>账号(字母开头，字母数字下划线组合，6-20位)：^[a-zA-z]\w{5,20}$</li>								
								<li>e</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
</html>

<!-- formLoad -->
<script type="text/javascript">
	var txtPattern = gId("txtPattern");
	var txtString = gId("txtString");
	var chkAuto = gId("chkAuto");
	var divInvalid = gId("divInvalid");
	// ------------------------------------------------------------------------
	function formLoad() {
		init();
	}
</script>
<!-- 页面控件处理 -->
<script type="text/javascript">
	function init() {
		txtPattern.value = getLocalItem("pattern");
		txtString.value = getLocalItem("string");
		chkAuto.checked = getLocalItem("auto").equals("1");

		if (txtPattern.value.equals("")) {
			txtPattern.value = "[0-9]$";
		}
	}

	function btnTest_click() {
		RegExpTest();
	}
	function txtPattern_keypress() {
		if (chkAuto.checked) {
			RegExpTest();
		}
	}
	function txtString_keypress() {
		if (chkAuto.checked) {
			RegExpTest();
		}
	}
</script>

<!-- RegExp.test() -->
<script type="text/javascript">
	function RegExpTest() {
		var blResult = false;
		var pattern = txtPattern.value.trim();
		var string = txtString.value.trim();
		// ------------------------------------------------
		divInvalid.innerHTML = "验证失败";
		try {
			blResult = (new RegExp(pattern)).test(string);
		}
		catch (e) {
			divInvalid.innerHTML = e.toString();
		}

		if (blResult) {
			txtString.className = "form-control";
		}
		else {
			txtString.className = "form-control is-invalid";
		}
		// ------------------------------------------------
		setLocalItem("pattern", pattern);
		setLocalItem("string", string);
		setLocalItem("auto", chkAuto.checked ? "1" : "0");
	}
</script>