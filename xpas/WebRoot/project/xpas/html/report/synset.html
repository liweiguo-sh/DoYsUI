<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>打印配送</title>
     <script type="text/javascript">
        //不要xwf.uvform.css
        window.css_xwf_uvform = false;
    </script>
	<script src="../../../../res/jscript/xwf.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.ajax.js" type="text/javascript"></script>	
	<script src="../../../../res/jscript/xwf.const.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.datatable.js" type="text/javascript"></script>
	<script src="../../../../res/control/uvform/xwf.uvform.js" type="text/javascript"></script>

	<script src="../../../../res/jscript/xwf.css.js" type="text/javascript"></script>
	
	<script src="../../../../res_plugin/zui-1.8.1-dist/lib/jquery/jquery.js" type="text/javascript"></script>
    <script src="../../../../res_plugin/zui-1.8.1-dist/js/zui.js" type="text/javascript"></script>
	<script src="../../../../res_plugin/zui-1.8.1-dist/lib/prettify/prettify.js" type="text/javascript"></script>
    <script src="../../../../res_plugin/zui-1.8.1-dist/js/zuiExt.js" type="text/javascript"></script>
    <link href="../../../../res_plugin/zui-1.8.1-dist/css/zui.css" rel="stylesheet" type="text/css" />
    <link href="../../../../res_plugin/zui-1.8.1-dist/css/zuiExt.css" rel="stylesheet" type="text/css" />
    
    <script src="../../../../res_plugin/jquery/jquery-migrate-1.2.1.js" title="jQuery migrate插件解决迁移兼容问题"></script>
	<script src="../../../../res_plugin/jquery/jquery-barcode.min.js" title="条形码"></script>
	<script src="../../../../res/jscript/jquery.qrcode.min.js"></script>
	 
	 <style type="">
	 	 textarea{
	 	 	    font-size: 16px;
	 	 }
	 	
	 	
	 </style>
</head>
<body style="width:1000px">
<div class="container-fluid container-fluid-main scrollbar-hover" id="container-uview-edit">
 <input type="hidden" id="_cId"/>
	<div class="row">
		<div class="col-xs-12" id="divDC">
		</div>
	</div>
	<div class="row">
		<div class="col-xs-3" >
			<div class="form-group with-padding">
       			<label  class=" with-padding" >同步名称<span style="color:chocolate;"> *</span> </label>
       			<input  id="_cname" type="text"  class="tdcontrol form-control" placeHolder="描述该同步任务的功能"  style="width: 80%;" />
       		</div>
		</div>
		<div class="col-xs-3" >
			<div class="form-group with-padding">
       			<label  class=" with-padding" >临时表名<span style="color:chocolate;"> *</span></label>
       			<input  class="tdcontrol  form-control" id="_ctable_name_tmp" type="text"   style="width: 80%;"   />
       		</div>
		</div>
		<div class="col-xs-3" >
			<div class="form-group with-padding">
       			<label  class=" with-padding" >索引列</label>
       			<input  class="tdcontrol  form-control" id="_cindex_fields" placeHolder="索引列，多个,分割" type="text"   style="width: 80%;"   />
       		</div>
		</div>
		<div class="col-xs-3" >
			<div class="form-group with-padding">
       			<label  class=" with-padding" >启用该同步</label><br>
       			<input    id="_castatus" type="checkbox" style="zoom: 200%;    margin: 0px;"/>
					 
       		</div>
		</div>
	</div>
	<div class="row">
		<div class="col-xs-8" >
			<div class="row">
				
				<div class="col-xs-12" >
					<label  class=" with-padding"  >数据源sql<span style="color:chocolate;"> *</span></label>
				</div>
				<div class="col-xs-12" >
					  <textarea  id="_csql_source" class="form-control"  rows="15" style="width:100%;" >
					  </textarea>
				</div>
				<div class="col-xs-12" >
					<label  class=" with-padding" >校验sql<span style="color:chocolate;"> *</span></label>
				</div>
				 <div class="col-xs-12" >
					 <textarea  id="_csql_source_check" class="form-control"  rows="5" style="width:100%;" >
					 	
					 </textarea>
				</div>
				 
			</div>
			
		</div>
		<div class="col-xs-4" >
			 <h1 class="text-center">说明</h1>
			  <h4 class="text-left">适用于统计报表，对外视图快照。同步定时任务创建sqlid=309,默认禁用的。如果是通用的中间表同步配置，请将升级sql放到升级脚本里面</h4>
			   <h3 class="text-left">临时表名</h4>
			  <h4 class="text-left">不允许重复，建议格式【视图名称】【_syntmp】</h4>
			   <h3 class="text-left">索引列</h4>
			  <h4 class="text-left">在哪些字段设置索引，连接条件的字段需要设置</h4>
			   <h3 class="text-left">数据源sql</h4>
			   <h4 class="text-left">需要快照的数据源</h4>
			    <h3 class="text-left">校验sql</h4>
			  <h4 class="text-left">校验数据源sql是否在临时表中存在，推荐:连接查询(exists或者in查询，性能随着数据多少不稳定) </h4>
			  <h1 class="text-center">示例</h1>
			  <h4 class="text-left">
			  	数据源sql:<br>select ts.* from t_material ts
			  </h4>
			  <h4 class="text-left">
			  	校验sql:<br>
			  	 left join  t_material_syntmp tmp on  <span style="color: red;">tmp.material_id</span>=<span style="color: red;">ts.material_id </span>
  				<br>where  <span style="color: red;">tmp.material_id is null </span> 
			  </h4>
			   <h4 class="text-left">
			  	索引列:<br>material_id
			  </h4>
		</div>
		 
	</div>
	

</div>
</body>
</html>

<!-- formLoad -->
<script type="text/javascript">
	function formLoad() {
		 
    }
     vf.afterSave = function (prop) {
       	zuiExt.msg({msg:"保存成功",type:"success"});
        return true;
     }
     
     
    //表单状态更新后执行
    vf.afterSetStatus = function () {
        if ("addnew".equals(vf.status)) {		//新增 
           $("#_csql_source").val("select * from t_material ts");
           var _csql_source_check=" left join  t_material_syntmp tmp on  tmp.material_id=ts.material_id \n ";
           _csql_source_check+=" where tmp.material_id is null ";
           $("#_csql_source_check").val(_csql_source_check);
        }  
    }
     
</script>
