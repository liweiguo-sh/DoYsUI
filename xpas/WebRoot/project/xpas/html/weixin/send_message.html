<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>发送消息测试界面</title>
	<script src="../../../../res/jscript/xwf.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.ajax.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.const.js" type="text/javascript"></script>
	
	<style type="text/css">
		td {
			border: solid 1px blue;
		}
	</style>
</head>
<body>
	<table style="width:600px;">
			<tr>
				<td style="width:120px;">服务号：</td>
				<td style="width:350px;">
				<select id="selServiceKey" style="width:350px;">				
					<option value="jiaba">驾吧</option>
					<option value="jiaolianba">教练吧</option>
				</select>
			</td>
			</tr>
			<tr>
			<td style="width:120px;">微信账号：</td>
			<td style="width:350px;">
				<select id="selOpenId" style="width:350px;">				
					<option value="oq_Hqt2GmL2XV_9__8j-0hFApGkE">驾吧：李卫国iPhone 6</option>				
					<option value="oXqCiuPezZ5fqy0vYsxLBmAd7Kgc">教练吧：李卫国iPhone 6</option>
				</select>
			</td>
		</tr>
		<tr>
			<td>消息内容：</td>
			<td>
				<textarea id="txtContent" rows="5" cols="0" style="width:350px;">这是测试消息...<a href='http://www.masoprint.com/'>码尚</a></textarea>
			</td>
		</tr>
		<tr>
			<td colspan="2">
				<input type="button" id="btnSendTextMsg" value="发送文本消息" onclick="btnSendTextMsg_click();" />
				&nbsp;&nbsp;&nbsp;&nbsp;
				<input type="button" id="btnSendNewsMsg" value="发送图文信息" onclick="btnSendNewsMsg_click();" />
			</td>
		</tr>
		<tr>
			<td>取临时二维码：</td>
			<td>
				场景号：<input type="text" id="txtSceneId" value="1" /><br />
				<input type="text" id="txtQrTicket" value="ticket" style="width:400px;" /><br />
				<input type="text" id="txtQrUrl" value="url" style="width:400px;" /><br />
				<input type="text" id="txtQrUrlImg" value="urlImg" style="width:400px;" /><br />
				<img id="imgQR" alt="二维码图片" src="" style="width:300px;height:300px;" /><br />
				<input type="button" id="btnGetQrTemp" value="取临时二维码" onclick="return btnGetQR_click(0);" />
				<input type="button" id="btnGetQr" value="取永久二维码" onclick="return btnGetQR_click(1);" />
			</td>
		</tr>
	</table>
</body>
</html>

<script type="text/javascript">
	var selOpenID = gId("selOpenID");
	var txtContent = gId("txtContent");

	function btnSendTextMsg_click() {
		if (g.a.send("processType=com.xznext.weixin.Example&actionType=sendTextMessageTest", { serviceKey: selServiceKey.value, openId: selOpenId.value, content: txtContent.value }, true)) {
			if (g.a.OK) {
				win.flashTitle("文本消息发送成功。");
			}
			else {
				return false;
			}
		}
		else {
			return false;
		}
	}
	function btnSendNewsMsg_click() {
		if (g.a.send("processType=com.xznext.weixin.Example&actionType=sendNewsMessageTest", { serviceKey: selServiceKey.value, openId: selOpenId.value }, true)) {
			if (g.a.OK) {
				win.flashTitle("图文信息发送成功。");
			}
			else {
				return false;
			}
		}
		else {
			return false;
		}
	}
</script>

<!-- 二维码 --->
<script type="text/javascript">
	function btnGetQR_click(qrType) {
		if (g.a.send("processType=wxt.weixin.Example&actionType=getQR", { sceneId: gId("txtSceneId").value, qrType: qrType }, true)) {
			if (g.a.OK) {
				var cReturn = g.a.cReturn;
				gId("txtQrTicket").value = cReturn.ticket;
				gId("txtQrUrl").value = cReturn.url;
				gId("txtQrUrlImg").value = cReturn.urlImg;
				gId("imgQR").src = cReturn.urlImg;
			}
			else {
				return false;
			}
		}
		else {
			return false;
		}
	}
</script>
