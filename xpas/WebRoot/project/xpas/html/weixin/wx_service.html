<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>微信服务号维护</title>
	<script src="../../../../res/jscript/xwf.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.ajax.js" type="text/javascript"></script>	
	<script src="../../../../res/jscript/xwf.const.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.datatable.js" type="text/javascript"></script>
	<script src="../../../../res/control/uvform/xwf.uvform.js" type="text/javascript"></script>
	<script src="../../../../res/control/My97DatePicker/WdatePicker.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.css.js" type="text/javascript"></script>
</head>
<body>
	<div id="divDC"></div>
	<form id="frm" action="" target="">
		<table id="tbForm" class="tbForm" style="width:705px;">
			<tr class="trH">
				<th style="width:150px;"></th>
				<th style="width:200px;"></th>
				<th style="width:150px;"></th>
				<th style="width:200px;"></th>
			</tr>
			<tr>				
				<td>Service Key：</td>
				<td><input type="text" id="_cService_key" value="" /></td>
				<td>Service Name：</td>
				<td><input type="text" id="_cService_name" value="" /></td>
			</tr>
			<tr>				
				<td>App ID：</td>
				<td><input type="text" id="_cApp_id" value="" /></td>
				<!--
				<td>App Secret：</td>
				<td><input type="text" id="_cApp_secret" value="" /></td>
				-->
			</tr>
			<tr>
				<td>备注：</td>
				<td colspan="3"><textarea id="_cService_remark" rows="3" cols="0"></textarea></td>
			</tr>
		</table>
	</form>
</body>
</html>

<!-- formLoad -->
<script type="text/javascript">
	// ----------------------------------------------------
	function formLoad() {
		vf.addExtraButton({ key: "refreshMenu", text: "刷新菜单" });
		vf.addExtraButton({ key: "downloadGroups", text: "下载用户组" });
		vf.css(gId("tbForm"));
	}
</script>

<!-- vf envets -->
<script type="text/javascript">
	vf.beforeClick = function (prop) {
		var buttonKey = prop.buttonKey;
		if (buttonKey.equals("refreshMenu")) {
			if (g.a.send("processType=com.xznext.weixin.Menu&actionType=createMenu", { ServiceKey: frm._cService_key.value }, true)) {
				if (g.a.OK) {
					win.flashTitle("菜单重建成功。");
				}
				else {
					return false;
				}
			}
			else {
				return false;
			}
		}
		else if (buttonKey.equals("downloadGroups")) {
			if (g.a.send("processType=com.xznext.weixin.MemberGroup&actionType=downloadGroups", { serviceKey: frm._cService_key.value }, true)) {
				if (g.a.OK) {
					win.flashTitle("下载用户组成功。");
				}
				else {
					return false;
				}
			}
			else {
				return false;
			}
		}
		return false;
	}
</script>