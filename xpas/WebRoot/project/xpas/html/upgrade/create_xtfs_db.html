<!DOCTYPE html>
<html>
<head>
    <title>创建分支xTFS库</title>
    <script src="../../../../res/jscript/xwf.js" type="text/javascript"></script>
    <script src="../../../../res/jscript/xwf.ajax.js" type="text/javascript"></script>
    <script src="../../../../res/jscript/xwf.const.js" type="text/javascript"></script>

    <script src="../../../../res/jscript/xwf.css.js" type="text/javascript"></script>

    <style type="text/css">
        body {
            overflow: hidden;
            font-family: 微软雅黑;
        }

        #btnUpgrade {
            color: Orange;
        }

            #btnUpgrade:hover {
                color: Yellow;
            }        

        .divMessage {
            overflow: auto;
            margin-top: 15px;
            font-size: 11pt;
            line-height: 24px;
            background-color: White;
        }

        .errMessage {
            color: Red;
        }
    </style>
</head>
<body>
    <div id="divButton" class="uvButtons">
        <input type="button" id="btnClose" onclick="btnClose_click();" value="关闭" />
        <input type="button" id="btnCreate" onclick="btnCreate_click();" value="一键创建" />
    </div>
    <div class="PanelA">
        <div id="divMessage" class="divMessage"></div>
    </div>
</body>
</html>

<!-- formLoad -->
<script type="text/javascript">
    var divMessage = gId("divMessage");
    // ------------------------------------------------------------------------
    function formLoad() {
        formResize();
    }

    function formResize() {
        divMessage.style.height = (win.p.height - divMessage.offsetTop - 20) + "px";
    }

    function btnClose_click() {
        win.close();
    }
</script>

<!-- 一键升级 -->
<script type="text/javascript">
    function btnCreate_click() {
        var d1 = new Date();

        clearMessage();
        writeMessage("一键创建xTFS库开始，请耐心等待 ......");

        createXtfsDb();
        writeMessage("总计耗时：" + g.x.timeInterval(d1, new Date()) + "。");
    }

    function createXtfsDb() {
        if (g.a.send("processType=com.xtfs.XtfsDbCreate&actionType=createXtfsDb", {}, true)) {
            if (g.a.OK) {
                writeMessage("分支xTFS库创建成功");
            }
            else {
                return false;
            }
        }
        else {
            return false;
        }
    }
</script>

<!-- 辅助函数 -->
<script type="text/javascript">
    function clearMessage() {
        arrMessage = new Array();
        divMessage.innerHTML = "";
    }

    function writeError(strError) {
        arrMessage.push((new Date).toString("hh:mm:ss.ms") + " - <span class='errMessage'>" + strError + "</span>");
        divMessage.innerHTML = arrMessage.join("<br />");
    }
    function writeMessage(strMessage) {
        if (strMessage.equals("")) {
            arrMessage.push("");
        }
        else {
            arrMessage.push((new Date).toString("hh:mm:ss.ms") + " - " + strMessage);
        }
        divMessage.innerHTML = arrMessage.join("<br />");
    }
</script>