<!DOCTYPE html>
<html>
<head>
    <title>导航树节点定义</title>
	<script src="../../../../res/jscript/xwf.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.ajax.js" type="text/javascript"></script>	
	<script src="../../../../res/jscript/xwf.const.js" type="text/javascript"></script>
	<script src="../../../../res/jscript/xwf.datatable.js" type="text/javascript"></script>
	<script src="../../../../res/control/uvform/xwf.uvform.js" type="text/javascript"></script>

	<script src="../../../../res/jscript/xwf.css.js" type="text/javascript"></script>
</head>
<body>
	<div id="divDC"></div>
	<form id="frm" action="" target="">
		<table id="tbForm" class="tbForm" style="width:997px;">
			<tr class="trH">
				<th style="width:130px;"></th>
				<th style="width:200px;"></th>
				<th style="width:130px;"></th>
				<th style="width:200px;"></th>
				<th style="width:130px;"></th>
				<th style="width:200px;"></th>
			</tr>
			<tr>
				<td>节点层级：</td>
				<td><input id="_cTree_node_level" type="text" value="" /></td>
				<td>单一节点条件：</td>
				<td><input id="_cSingle_condition" type="checkbox" value="" /></td>
				<td>节点条件类型：</td>
				<td>
					<select id="_cTree_node_field_type">
						<option value="field">条件字段</option>
						<option value="sql">条件SQL</option>
					</select>
				</td>
			</tr>
			<tr>
				<td>字段或SQL：</td>
				<td colspan="5"><textarea id="_cTree_node_field" rows="8" cols="0"></textarea></td>
			</tr>
			<tr>
				<td>节点数据源：</td>
				<td colspan="5"><textarea id="_cTree_node_sql" rows="12" cols="0"></textarea></td>
			</tr>
			<tr>
				<td>备注：</td>
				<td colspan="5"><textarea id="_cTree_node_remark" rows="3" cols="0"></textarea></td>
			</tr>
		</table>
		<input type="hidden" id="_cTree_Key" value="" />
	</form>
</body>
</html>

<!-- formLoad -->
<script type="text/javascript">
	var frmParent = null;
	// ----------------------------------------------------
	function formLoad() {
		frmParent = win.parent.document.getElementById("frm");
		vf.css(gId("tbForm"));		
	}
</script>

<!-- uviewForm -->
<script type="text/javascript">
	vf.beforeSave = function () {
		// -- xTFS：判断是否已签出 ------------------------
		if (g.a.send("processType=com.xtfs.XtfsCore&actionType=getMDataStatus", { mdataType: "tree", mdataKey: frm._cTree_Key.value }, true)) {
			if (g.a.OK) {
				var cReturn = g.a.cReturn;
				if (!cReturn.newMData && !cReturn.myCheckout) {
					showWarn("主数据尚未签出，同步xTFS时修改会丢失，请谨慎操作。");
				}
			}
		}
		// ------------------------------------------------
		return true;
	}

	vf.afterAddnew = function () {
		frm._cTree_Key.value = frmParent._cTREE_KEY.value;
	}
</script>