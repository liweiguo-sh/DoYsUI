<!DOCTYPE html>
<html>

<head>
    <title>图表</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
   <script src="../../../../res_plugin/jquery/jquery-3.1.1.min.js" type="text/javascript"></script>

    <script src="../../../../res/jscript/xwf.js" type="text/javascript"></script>
    <script src="../../../../res/jscript/xwf.ajax.js" type="text/javascript"></script>
    <script src="../../../../res/jscript/xwf.const.js" type="text/javascript"></script>

    <script src="../../../../res/control/grid/xwf.grid.js" type="text/javascript"></script>
    <script src="../../../../res/control/grid/xwf.gridview.js" type="text/javascript"></script>

    <script src="../../../../res/jscript/excel.js" type="text/javascript"></script>

    <script src="../../../../res/jscript/_view.debug.js" type="text/javascript"></script>
    <script src="../../js/xtfs.js" type="text/javascript"></script>
    <script src="../../../../res/jscript/web_print.js" type="text/javascript"></script>

    <link rel="stylesheet" href="../../../../res_plugin/zui-1.8.1-dist/css/zui.min.css" />
    <link rel="stylesheet" href="../../../../res_plugin/zui-1.8.1-dist/lib/chosen/chosen.min.css" />
    <script src="../../../../res_plugin/zui-1.8.1-dist/js/zui.js"></script>
    <script src="../../../../res_plugin/zui-1.8.1-dist/lib/chosen/chosen.min.js"></script>
    <script src="../../../../res_plugin/zui-1.8.1-dist/js/zuiExt.js"></script>
    
    <script src="../../../../res_plugin/echarts/echarts.min.js"></script>
    <script src="../../../../res/jscript/echartModel.js?v=20190903"></script>
    
     <script src="../../../../res_plugin/bootstrap3.7/dtpicker/js/bootstrap-datetimepicker.min.js"></script>
    <script src="../../../../res_plugin/bootstrap3.7/dtpicker/js/locales/bootstrap-datetimepicker.zh-CN.js"></script>
    
   <link rel="stylesheet" href="../../../../res_plugin/bootstrap3.7/dtpicker/css/bootstrap-datetimepicker.min.css" />
   
   <script src=".../../../../res_plugin/zui-1.8.1-dist/lib/chosen/chosen.min.js"></script>
   <link rel="stylesheet" href="../../../../res_plugin/zui-1.8.1-dist/lib/chosen/chosen.min.css" />
</head>

<body>
    <div class="container-fluid" >
        <div class="row" id="toolbox">
        	<form class="form-inline form-filter" id="form-filter">
        		<div class="form-group with-padding">
        			<label  class=" with-padding" >X轴最大数量</label>
        			 <select  class="chosen-select-filter chosen-select form-control"  style="width:100px;" id="maxX">
        			 	<option value="5" selected="selected">5</option> 
        			 	<option value="10" >10</option> 
        			 	<option value="0" >全部显示</option> 
        			 </select>
        		</div>
	            <div class="btn-group">
				  <button type="button" class="btn  btn-primary" onclick="formtool.reloadEchart();">查询</button>
				  <button type="button" class="btn" onclick="formtool.resetEchart();">重置</button>
				  <button type="button" class="btn" onclick="win.close();">关闭</button>
				</div>
          </form>
        </div>
        <div class="row">
            <div class="col-md-12 with-padding">
            	<div id="myechart"  style="height: 400px;"></div>
            </div>
        </div>
    </div>
</body>
</html>

<script type="text/javascript">
var viewKey,echartModel,formtool={},charUse={};

function formLoad() {
    $("#myechart").height(window.innerHeight-$("#toolbox").outerHeight()-10);
	//接受参数,url参数优先级低
    var param={};
    viewKey=win.para.viewKey;
    var viewFormParam=getUrlPara(win.p.viewForm);
    console.log(viewFormParam)
    for (var key in viewFormParam) {
        param[key] = viewFormParam[key];
    }
    
    //加载相关JS，参数优先级高
    g.a.attachJavaScriptFile(g.appPath + "project/g_spd/js/chart/chart."+viewKey+".js?v=20190918");
    if(charUse && charUse.getCharParam){
    	 if(charUse.getCharParam ){
    	 	var param2=charUse.getCharParam();
    	 	 for (var key in param2) {
		        param[key] = param2[key];
		    }
    	 } 
    }
    param.echartId="myechart";
    param.chartReportKey=viewKey;
    param.formId="form-filter";
    param.chartTitle=win.p.text;
    param.maxX=$("#maxX").val();
    console.log(param)
    
    //初始化图表
    echartModel=new echartModel(param);
    echartModel.loadData();
   
}

formtool.reloadEchart=function(){
	echartModel.maxX=$("#maxX").val();
	console.log(echartModel)
    echartModel.loadData();
}

formtool.resetEchart=function(){
	$("#form-filter input").val("");
	
	$("#form-filter select.chosen-select-filter").val("").trigger("chosen:updated");
    echartModel.loadData();
}



    
</script>