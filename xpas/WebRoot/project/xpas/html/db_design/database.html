<!DOCTYPE html>
<html>
<head>
    <title>数据库管理</title>
	<script src="../../../../res/jscript/xwf.js"></script>
	<script src="../../../../res/jscript/xwf.ajax.js"></script>	
	<script src="../../../../res/jscript/xwf.const.js"></script>
	<script src="../../../../res/control/uvform/xwf.uvform.js"></script>

	<script src="../../../../res/jscript/xwf.css.js"></script>

	<style type="text/css">
	    #aBak {
			color: red;
		}
	</style>
</head>
<body>
	<div id="divDC"></div>
	<form id="frm" action="" target="com.db_design.Database">
		<table id="tbForm" class="tbForm" style="width:625px;">
			<tr class="trH">
				<th style="width:130px;"></th>
				<th style="width:180px;"></th>
				<th style="width:130px;"></th>
				<th style="width:180px;"></th>
			</tr>
			<tr>
				<td>数据库标识</td>
				<td><input id="_cDatabase_Key" type="text" value="" /></td>
				<td>数据库类型</td>
                <td><input id="_cDatabase_Type" type="text" controlType="dropdown" fieldValue="dbTypeKey" fieldText="dbTypeText" dataSource="[['dbTypeKey','dbTypeText'],['SQLServer','SQL Server'],['Oracle','Oracle'],['DB2','DB2'],['MySQL','MySQL'],['Access','MS Access',]]" visibleSearch="false" /></td>
			</tr>
			<tr>
				<td>数据库名称</td>
				<td><input id="_cDatabase_Text" type="text" value="" /></td>				
				<td>数据库版本</td>
				<td><input id="_cDatabase_Version" type="text" value="" /></td>
			</tr>
			<tr>
				<td>数据库物理名称</td>
				<td><input id="_cDatabase_Name" type="text" value="" /></td>				
				<td>表前缀</td>
				<td><input id="_cDatabase_Owner" type="text" value="" /></td>
			</tr>
			<tr>
				<td>备注</td>
				<td colspan="3"><textarea id="_cDatabase_Remark" rows="3" cols="0"></textarea></td>
			</tr>
			<tr>
				<td>备份</td>
				<td colspan="3"><a id="aBak" style="display:none;" target="_blank">abc</a></td>
			</tr>
		</table>
	</form>
</body>
</html>

<!-- formLoad -->
<script>
	var aBak = gId("aBak");
	// ----------------------------------------------------
	function formLoad() {
        vf.addExtraButton({ key: "refreshDatabase", text: "刷新库结构" });
		vf.addExtraButton({ key: "dropZeroTable", text: "删除0数据表" });
		vf.addExtraButton({ key: "backupDatabase", text: "备份数据库", title: "前提条件：数据库服务器和应用服务器在同一台物理服务器上" });
		vf.css(gId("tbForm"));
	}
</script>

<script>
	vf.afterClick = function (prop) {
		var btnKey = prop.buttonKey;

		if (g.a.OK) {
			var cReturn = g.a.cReturn;

			if (btnKey.equals("backupDatabase")) {
                var bakName = cReturn.bakName;
                var urlBak = g.xpasRunPath + "db_bak/" + bakName;
				
                aBak.href = urlBak;
				aBak.innerHTML = bakName;
                aBak.style.display = "";
			}
			else {
				showMsg(cReturn["result"]);
			}
		}
		else {
			return;
		}
	}
</script>