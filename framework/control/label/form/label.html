<!DOCTYPE html>
<html>
<head>
    <title>标签定义</title>
    <script src="../../../core/doys.js?v=1"></script>
    <script>
        importFrameworkRes("d-label");
    </script>
    <style type="text/css">
        body {
            overflow-x: hidden;
        }

        .el-col-base {
            padding-right: 20px;
        }
    </style>
</head>
<body>
    <div id="app" style="width:900px;height:500px;">
        <el-tabs v-model="activeTabName" type="card">
            <el-tab-pane label="基本信息" name="base" v-if="false">
                <el-form label-width="120px" label-position="right">
                    <el-row>
                        <el-col :span="12" class="el-col-base">
                            <el-form-item label="宽度">
                                <el-input v-model="head.width"></el-input>
                            </el-form-item>
                        </el-col>
                        <el-col :span="12" class="el-col-base">
                            <el-form-item label="高度">
                                <el-input v-model="head.height"></el-input>
                            </el-form-item>
                        </el-col>
                    </el-row>
                </el-form>
            </el-tab-pane>
            <!-- 条码、文本、图片 -->
            <el-tab-pane label="Script: AfterComputer" name="jsAfterCompute">
                <el-input v-model="head.scriptAfterCompute" type="textarea" :rows="20" placeholder="请输入脚本" spellcheck="false"></el-input>
            </el-tab-pane>            
        </el-tabs>
    </div>
</body>
</html>

<!-- appInit -->
<script>
    var app = new Vue({
        el: '#app',
        data: {
            span: [24, 12, 12],
            activeTabName: "jsAfterCompute",

            head: {},

            remark: ""
        },
        methods: {
            elementTypeChange() {
                if (this.head.elementType.equals("barcode")) {
                    if (!this.head.barcodeType) {
                        this.head.barcodeType = "CODE_128";
                        this.position.textAlign = "center";
                    }

                    if (!this.segments || this.segments.length == 0) {
                        this.segments = [
                            UtilElement.getFixedSegment({ pos: 0 }),
                            UtilElement.getBlankSegment({ pos: 1 })
                        ];
                    }
                }
                if (this.head.elementType.equals("barcode") || this.head.elementType.equals("text")) {
                    if (!this.sections || this.sections.length == 0) {
                        this.sections = [
                            UtilElement.getFixedSection({ pos: 0 }),
                            UtilElement.getBlankSection({ pos: 1 })
                        ];
                    }
                }
                if (this.head.elementType.equals("image")) {                    
                    if (!this.image) {
                        this.image = {
                            "value": this.images.length > 0 ? this.images[0].k : "",
                            "deformation": "zoom"
                        };
                    }
                }

                this.reComputer();
            }
        }
    });
</script>

<!-- winLoad -->
<script>
    function winLoad() {
        app.head = win.para.head;

        // ------------------------------------------------
        win.addEventListener("afterClose", () => {
            if (win.para.callback) {
                win.para.callback({ _this: win.para._this });
            }
            app.$destroy();
        });
    }
</script>